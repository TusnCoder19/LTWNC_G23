@model G23NHNT.Models.HomeViewModel
@{
    ViewData["Title"] = "Trang Chủ";
    var userRole = ViewBag.UserRole;
}

<link rel="stylesheet" href="~/css/index.css" asp-append-version="true" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<div class="container-fluid mt-3">
    <div class="d-flex justify-content-start mb-4">
        <input type="text" class="form-control" placeholder="Tìm kiếm..." style="width: 300px; margin-right: 10px;">
        <button class="btn btn-primary mr-2">Danh mục</button>
        @if (!User.Identity.IsAuthenticated || Model.IsChuTro)
        {
            <a asp-action="Create" asp-controller="House" class="btn btn-primary mr-2" style="margin-left: 10px;">
                Cung cấp thông tin nhà trọ
            </a>
            <a asp-action="ListHouseRoom" asp-controller="QuanLi" asp-route-userId="@ViewBag.userId" class="btn btn-primary mr-2"
               style="margin-left: 10px;">
                Quản lí bài đăng
            </a>
        }
    </div>

    <p>IsAuthenticated: @User.Identity.IsAuthenticated</p>
    <p>IsChuTro: @Model.IsChuTro</p>

    <h2>Danh Sách Nhà Trọ</h2>
    <div class="container-body">
        <div class="row">
            @foreach (var house in Model.Houses)
            {
                <div class="col-md-3 mb-4">
                    <div class="card">
                        <img src="@house.HouseDetails.FirstOrDefault()?.Image" class="card-img-top" alt="@house.NameHouse"
                             style="height: 200px; object-fit: cover;">
                        <div class="card-body">
                            <h5 class="card-title">@house.NameHouse</h5>
                            <p class="card-text"><strong>Địa chỉ:</strong> @house.HouseDetails.FirstOrDefault()?.Address</p>
                            <p class="card-text">
                                <strong>Giá nhà:</strong>
                                @house.HouseDetails.FirstOrDefault()?.Price.ToString("#,0", new
                                         System.Globalization.CultureInfo("vi-VN")) VND
                            </p>
                            <p class="card-text">
                                <strong>Diện tích:</strong> @house.HouseDetails.FirstOrDefault()?.DienTich
                                m²
                            </p>
                            <p class="card-text">
                                <strong>Ngày đăng:</strong>
                                @house.HouseDetails.FirstOrDefault()?.TimePost.ToString("dd/MM/yyyy")
                            </p>
                            <a asp-controller="Home" asp-action="Detail" asp-route-id="@house.IdHouse"
                               asp-route-type="house" class="btn btn-view-detail">
                                <i class="fas fa-eye icon"></i> Xem Chi Tiết
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<script>function promptLogin(loginUrl) {
        alert("Bạn cần đăng nhập với tư cách là chủ trọ để đăng bài.");
        window.location.href = loginUrl;
    }</script>
